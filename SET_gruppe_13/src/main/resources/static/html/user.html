<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Document</title>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
</head>

<body>
<div class="mt-5 container">
  <h1>User Profile</h1>
  <p class="name"></p>
  <p class="epost"></p>
  <p class="mobil"></p>
  <p class="adresse"></p>
  <p class="postnummer"></p>
  <a type="button" class="btn btn-primary logout" onclick="logout()">Logout</a>
</div>
</body>
<script>


  let user = null;      // Holds the fetched user data
  var loading = true;  // Shows loading state
  var error = null;     // Shows error message if the fetch fails
  const queryString = document.location.search;
  const params = new URLSearchParams(queryString);
  const id = params.get("id");
  console.log(id);

  if (!id) {
    document.location.href = "products.html";

  }

  fetchUserData(id);

  // Function to fetch user data based on ID
  async function fetchUserData(userId) {
    try {
      const response = await fetch(`/api/user/${userId}`); // Use `userId` in the fetch URL
      console.log(userId);
      if (!response.ok) {
        throw new Error('Failed to fetch user data');
      }
      let user = await response.json(); // Parse and store the JSON response
      console.log(user);
      let name = document.querySelector(".name");
      name.innerHTML = `${ user.fornavn}  ${ user.etternavn}`;
      let epost = document.querySelector(".epost");
      epost.innerHTML = `${ user.epost} `;
      let mobil = document.querySelector(".mobil");
      mobil.innerHTML = `${ user.mobil} `;
      let adresse = document.querySelector(".adresse");
      adresse.innerHTML = `${  user.address.adresse } `;
      let postnummer = document.querySelector(".postnummer");
      postnummer.innerHTML = `${  user.address.postnummer } `;
    } catch (error) {
      this.error = error.message; // Set error message if something goes wrong
    } finally {
      this.loading = false; // Stop the loading spinner
    }
  }

  /*function logout(){
  window.location = `http://localhost:8080/logout/${id}`
  }*/

</script>

</html>